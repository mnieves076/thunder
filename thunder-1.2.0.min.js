let Thunder={};Thunder.VERSION="1.2.0",Thunder.DEBUG=!1,Thunder.ID=0,Thunder.VERTICAL=0,Thunder.HORIZONTAL=1;let scripts=document.getElementsByTagName("script"),i=scripts.length;for(;i--;){let t=scripts[i].src.match(/(^|.*\/)thunder-(.*)\.js$/);t&&(Thunder.ROOT=t[1])}!function(){let t=!1,e=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.BaseObject=function(){},BaseObject.extend=function(n){let o=this.prototype;t=!0;let h=new this;for(let u in t=!1,n)h[u]="function"==typeof n[u]&&"function"==typeof o[u]&&e.test(n[u])?function(t,e){return function(){let n=this._super;this._super=o[t];let h=e.apply(this,arguments);return this._super=n,h}}(u,n[u]):n[u];function a(){!t&&this.init&&this.init.apply(this,arguments)}return a.prototype=h,a.prototype.constructor=a,a.extend=arguments.callee,a}}(),Thunder.Object=BaseObject.extend({init:function(){this.listeners=[],this.responders={},this.eventQueue=new Thunder.EventQueue(this,this.handleEvents,0)},handleEvents:function(t){for(let e=0,n=t.length;e<n;e++){let o=this.responders[t[e].name];void 0!==o&&o.apply(this,[t[e]])}},addListener:function(t){this.listeners.push(t)},removeListener:function(t){for(let e=0,n=this.listeners.length;e<n;e++)if(this.listeners[e]===t)return this.listeners.splice(e,1),!0;return!1},removeListeners:function(){for(let t=0,e=this.listeners.length;t<e;t++)this.listeners[t]=null;this.listeners=[]},addResponder:function(t,e){this.responders[t]=e},removeResponder:function(t){delete this.responders[t]},removeResponders:function(){this.responders={}},broadcastEvent:function(t,e,n){void 0===n&&(n=0);for(let o=0,h=this.listeners.length;o<h;o++)this.listeners[o].addEvent(t,n,this,e)},broadcastUniqueEvent:function(t,e,n){void 0===n&&(n=0);for(let o=0,h=this.listeners.length;o<h;o++)this.listeners[o].addUniqueEvent(t,n,this,e)},trace:function(t){window.console&&Thunder.DEBUG&&console.log(t)}}),Thunder.DisplayObject=Thunder.Object.extend({init:function(t){this._super(),this.container=t,this.position=new Thunder.Point(0,0),this.isVisible=!0,this.alpha=1,this.width=0,this.height=0,this.eventMap=null},move:function(t,e){if(null!==this.container){let n=this.container.getBoundingClientRect();this.container.style.top=n.top+e+"px",this.container.style.left=n.left+t+"px"}this.position.addValues(t,e)},setPosition:function(t,e){null!==this.container&&(this.container.style.top=e+"px",this.container.style.left=t+"px"),this.position.setValues(t,e)},getPosition:function(){return this.position},getX:function(){return this.position.x},setX:function(t){null!==this.container&&(this.container.style.left=t),this.position.x=t},getY:function(){return this.position.y},setY:function(t){null!==this.container&&(this.container.style.top=t),this.position.y=t},setVisible:function(t){this.isVisible=t,null!==this.container&&(this.isVisible?this.container.style.display="":this.container.style.display="none")},getVisible:function(){return this.isVisible},setWidth:function(t){isNaN(t)||(null!==this.container&&(this.container.style.width=t+"px"),this.width=t)},getWidth:function(){return this.width},setHeight:function(t){isNaN(t)||(null!==this.container&&(this.container.style.height=t+"px"),this.height=t)},getHeight:function(){return this.height},setMask:function(t,e,n,o){null===this.container||isNaN(t)||isNaN(e)||isNaN(n)||isNaN(o)||(this.container.style.width=e+"px",this.container.style.height=n+"px",this.container.style.overflow="hidden")},setAlpha:function(t){null!==this.container&&(this.container.style.opacity=t),this.alpha=t},getAlpha:function(){return this.alpha},setContainer:function(t){this.container=t},getContainer:function(){return this.container},rotate:function(t){this.container.style.transform="rotate("+t+"deg)",this.container.style.webkitTransform="rotate("+t+"deg)",this.container.style.mozTransform="rotate("+t+"deg)",this.container.style.oTransform="rotate("+t+"deg)",this.container.style.msTransform="rotate("+t+"deg)"},setZIndex:function(t){this.container.style.zIndex=t},mapEvents:function(t){return null!=this.eventMap&&this.unMapEvents(),this.eventMap=new Thunder.EventMap(this.container,this,t),this},unMapEvents:function(){return null!=this.eventMap&&(this.eventMap.unMapEvents(),!0)},getEventMap:function(){return this.eventMap}}),Thunder.Component=Thunder.DisplayObject.extend({init:function(t){this._super(t),this.customizers={},this.assetManager=new Thunder.AssetManager,this.layerManager=new Thunder.LayerManager(this.container,this.handleCustomization,this)},handleCustomization:function(t){for(let e=0,n=t.length;e<n;e++){let o=this.customizers[t[e].type];void 0!==o&&o.apply(this,[t[e]])}},addCustomizer:function(t,e){this.customizers[t]=e},removeCustomizer:function(t){delete this.customizers[t]},setContainer:function(t){this.container=t,this.layerManager.setContainer(this.container)}}),Thunder.Event=function(t,e,n,o){this.name=t,this.delay=new Date().getTime()+e,this.owner=n,this.eventObject=o},Thunder.Event.prototype={getName:function(){return this.name},getLocalEventPosition:function(){let t=this.eventObject;(void 0!==this.eventObject.touches||void 0!==this.eventObject.changedTouches)&&(t=this.eventObject.touches[0]||this.eventObject.changedTouches[0]);let e=this.owner.container.getBoundingClientRect(),n=t.pageX-e.left,o=t.pageY-e.top;return new Thunder.Point(n,o)}},Thunder.EventMap=function(t,e,n){this.container=t,this.owner=e,this.eventQueue=n,this.mapEvents(),Thunder.DEBUG||document.addEventListener("contextmenu",t=>t.preventDefault())},Thunder.EventMap.prototype={mapEvents:function(){let t=this;t.mouseupListener=function(e){return t.eventQueue.addEvent("MOUSEUP",0,t.owner,e),!1},t.mousedownListener=function(e){return t.eventQueue.addEvent("MOUSEDOWN",0,t.owner,e),!1},t.mouseenterListener=function(e){return t.eventQueue.addEvent("MOUSEENTER",0,t.owner,e),!1},t.mouseleaveListener=function(e){return t.eventQueue.addEvent("MOUSELEAVE",0,t.owner,e),!1},t.dblclickListener=function(e){return t.eventQueue.addEvent("DOUBLECLICK",0,t.owner,e),!1},t.touchstartListener=function(e){return e.preventDefault(),t.eventQueue.addEvent("MOUSEDOWN",0,t.owner,e),!1},t.touchendListener=function(e){return e.preventDefault(),t.eventQueue.addEvent("MOUSEUP",0,t.owner,e),!1},t.tapListener=function(e){return e.preventDefault(),t.eventQueue.addEvent("MOUSEUP",0,t.owner,e),!1},this.container.addEventListener("mouseup",t.mouseupListener),this.container.addEventListener("mousedown",t.mousedownListener),this.container.addEventListener("mouseenter",t.mouseenterListener),this.container.addEventListener("mouseleave",t.mouseleaveListener),this.container.addEventListener("dblclick",t.dblclickListener),this.container.addEventListener("touchstart",t.touchstartListener),this.container.addEventListener("touchend",t.touchendListener),this.container.addEventListener("tap",t.tapListener)},unMapEvents:function(){this.container.removeEventListener("mouseup",this.mouseupListener),this.container.removeEventListener("mousedown",this.mousedownListener),this.container.removeEventListener("mouseenter",this.mouseenterListener),this.container.removeEventListener("mouseleave",this.mouseleaveListener),this.container.removeEventListener("dblclick",this.dblclickListener),this.container.removeEventListener("touchstart",this.touchstartListener),this.container.removeEventListener("touchend",this.touchendListener),this.container.removeEventListener("tap",this.tapListener)},mapMouseMoveEvent:function(){let t=this;t.mousemoveListener=function(e){return t.eventQueue.addUniqueEvent("MOUSEMOVE",10,t.owner,e),!1},t.touchmoveListener=function(e){return e.preventDefault(),t.eventQueue.addUniqueEvent("MOUSEMOVE",10,t.owner,e),!1},this.container.addEventListener("mousemove",t.mousemoveListener),this.container.addEventListener("touchmove",t.touchmoveListener)},unMapMouseMoveEvent:function(){this.container.removeEventListener("mousemove",this.mousemoveListener),this.container.removeEventListener("touchmove",this.touchmoveListener)}},Thunder.KeyEventMap=function(t,e){this.container=t,this.eventQueue=e,this.keyMap=[],this.mapKeyEvents()},Thunder.KeyEventMap.prototype={mapKeyEvents:function(){let t=this;t.keyPressListener=function(e){if(e.keyCode)e.keyCode;else{if(!e.which)return;e.which}t.addEventListenerKeyDown(k)},this.container.addEventListener("keypress",t.keyPressListener)},unMapKeyEvents:function(){this.container.removeEventListener("keypress",this.keyPressListener)},mapKey:function(t,e){this.keyMap[t]=e},onKeyDown:function(t){let e=this.keyMap[t];void 0!==e?this.eventQueue.addEvent(e,0,{keyCode:t}):this.eventQueue.addEvent("KEYUP",0,{keyCode:t})}},Thunder.EventQueue=function(t,e){this.callBackObject=t,this.callBackFunction=e,this.eventList=[],this.eventTimer=null},Thunder.EventQueue.prototype={addEvent:function(t,e,n,o){e||(e=0),null!==t&&""!==t&&(this.eventList.push(new Thunder.Event(t,e,n,o)),this.exitIdleState())},addUniqueEvent:function(t,e,n,o){this.removeEvent(t),this.addEvent(t,e,n,o)},eventInQueue:function(t){for(let e=0,n=this.eventList.length;e<n;e++)if(this.eventList[e].name===t)return!0;return!1},removeEvent:function(t){for(let e=0,n=this.eventList.length;e<n;e++)if(this.eventList[e].name===t)return this.eventList.splice(e,1),this.removeEvent(t),!0;return this.enterIdleState(),!1},removeAllEvents:function(){this.eventList=[],this.enterIdleState()},getNextEvent:function(){if(this.eventList.length>0){let t=this.eventList.shift();if(new Date().getTime()>=t.delay)return t;this.eventList.push(t)}else this.enterIdleState();return null},getEvents:function(){let t=[],e=[],n=new Date().getTime();for(let o=0,h=this.eventList.length;o<h;o++)n>=this.eventList[o].delay?e.push(this.eventList[o]):t.push(this.eventList[o]);return this.eventList=t.concat(),this.enterIdleState(),e},enterIdleState:function(){return 0===this.eventList.length&&(null!==this.eventTimer&&(clearInterval(this.eventTimer),this.eventTimer=null),!0)},exitIdleState:function(){if(this.eventList.length>0&&null==this.eventTimer){let t=this;this.eventTimer=setInterval(function(){t.callBackFunction.apply(t.callBackObject,[t.getEvents()])},10)}}},Thunder.Layer=Thunder.DisplayObject.extend({init:function(t,e,n,o){this._super(t),this.surface=e,this.layerSetName=n,this.layerId=o},clear:function(){for(;this.surface.lastChild;)this.surface.removeChild(this.surface.lastChild)},addAssets:function(t){for(let e=0,n=t.length;e<n;e++){let o="THUNDER_ASSET_"+Thunder.ID++,h=document.createElement("div");h.id=o,h.setAttribute("data-type",t[e].type),h.className="THUNDER_ASSET",h.style.position="absolute",h.style.top=t[e].getY()+"px",h.style.left=t[e].getX()+"px",h.style.width=void 0!==t[e].width?t[e].width+"px":"auto",h.style.height=void 0!==t[e].height?t[e].height+"px":"auto",this.surface.appendChild(h),t[e].setContainer(h)}},setMask:function(t,e,n,o){null===this.container||isNaN(t)||isNaN(e)||isNaN(n)||isNaN(o)||(this.container.style.width=e+"px",this.container.style.height=n+"px",this.container.style.overflow="hidden")}}),Thunder.LayerManager=function(t,e,n){this.container=t,this.callBackFunction=e,this.callBackObject=n,this.layers={sets:{},layer:null},this.index=0},Thunder.LayerManager.prototype={layOut:function(t,e){let n=this.get(e).layer;return null!=n&&(n.clear(),n.addAssets(t),this.callBackFunction.apply(this.callBackObject,[t])),n},addToLayOut:function(t,e){let n=this.get(e).layer;return null!=n&&(n.addAssets(t),this.callBackFunction.apply(this.callBackObject,[t])),n},getLayerObject:function(t){return this.get(t).layer},getLayerObjects:function(t){let e=this.get(t);if(null==e)return[];{let n=null==e.layer?[]:[e.layer];return n.concat(this.getChildLayers(e.sets))}},getChildLayers:function(t){let e=[];for(r in t)e.push(t[r].layer),e=e.concat(this.getChildLayers(t[r].sets));return e},addLayer:function(t){let e="THUNDER_LAYER_"+Thunder.ID++,n="THUNDER_LAYER_SURFACE_"+Thunder.ID++,o=document.createElement("div");o.id=n,o.className="THUNDER_LAYER_SURFACE",o.style.position="absolute",o.style.top="0px",o.style.left="0px";let h=document.createElement("div");h.id=e,h.setAttribute("data-path",t),h.className="THUNDER_LAYER",h.style.position="absolute",h.style.top="0px",h.style.left="0px",h.appendChild(o),this.container.appendChild(h),this.get(t).layer=new Thunder.Layer(h,o,t,e)},get:function(t){if("/"==t)return this.layers;let e=t.replace(/^\/|\/$/g,"").split("/"),n=this.layers.sets,o=null;for(s in e)n.hasOwnProperty(e[s])||(n[e[s]]={sets:{},layer:null}),n=(o=n[e[s]]).sets;return o},clearSet:function(t){let e=this.getLayerObjects(t);for(let n=0,o=e.length;n<o;n++)e[n].clear()},clearLayer:function(t){let e=this.get(t);null!=e&&e.layer.clear()},clearAll:function(){let t=this.getChildLayers(this.layers.sets);for(let e=0,n=t.length;e<n;e++)t[e].clear()},setLayerSetPosition:function(t,e){let n=this.getLayerObjects(t);for(let o=0,h=n.length;o<h;o++)n[o].setPosition(e.x,e.y)},moveLayerSet:function(t,e){let n=this.getLayerObjects(t);for(let o=0,h=n.length;o<h;o++){let u=n[o].getPosition().addPoint(e);n[o].move(u.x,u.y)}},setVisible:function(t,e){let n=this.get(t).layer;null!=n&&n.setVisible(e)},setLayerMask:function(t,e,n,o,h){let u=this.get(t).layer;null!=u&&u.setMask(e,n,o,h)},setContainer:function(t){this.container.children().appendChild(t),this.container=t},moveToLayer:function(t,e,n){let o=this.get(t).layer;return null!=o&&(n?o.surface.insertBefore(e,o.surface.querySelector(".THUNDER_ASSET")):o.surface.appendChild(e),!0)}},Thunder.Cookie=function(){},Thunder.Cookie.prototype={create:function(t,e,n){if(n){let o=new Date;o.setTime(o.getTime()+864e5*n),o.toGMTString()}document.cookie=t+"="+e+expires+"; path=/"},read:function(t){let e=t+"=",n=document.cookie.split(";");for(let o=0,h=n.length;o<h;o++){let u=n[o];for(;" "===u.charAt(0);)u=u.substring(1,u.length);if(0===u.indexOf(e))return u.substring(e.length,u.length)}return null},erase:function(t){this.create(t,"",-1)}},Thunder.Point=function(t,e){this.x=t,this.y=e},Thunder.Point.prototype={addPoint:function(t){return this.x+=t.x,this.y+=t.y,this},addValues:function(t,e){return this.x+=t,this.y+=e,this},setValues:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this.x===t.x&&this.y===t.y},getDistance:function(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))},getAngle:function(t){let e=270+Math.atan2(this.y-t.y,this.x-t.x)*(180/Math.PI);return e>360?e-360:e},getCopy:function(){return new Thunder.Point(this.x,this.y)},toString:function(){return"("+this.x+","+this.y+")"}},Thunder.Asset=Thunder.DisplayObject.extend({init:function(t,e,n,o){this._super(null),this.group=null,this.type=null,this.groupArray=[],this.typeArray=[],this.setGroups(t),this.setTypes(e),this.src=n,this.tag=o,this.width=null,this.height=null,this.param=null},attach:function(t){null!==this.container&&(this.container.innerHTML=t)},getName:function(){return this.name},setSize:function(t,e){this.width=t,this.height=e},getWidth:function(){return this.width},getHeight:function(){return this.height},setParam:function(t){this.param=t},setGroups:function(t){"string"==typeof t&&(this.group=t,this.groupArray=this.group.split("|"))},getGroup:function(){return this.group},getGroupArray:function(){return this.groupArray},setTypes:function(t){"string"==typeof t&&(this.type=t,this.typeArray=this.type.split("|"))},getType:function(){return this.type},getTypeArray:function(){return this.typeArray}}),Thunder.AssetManager=function(){this.assetList={},this.assetTagList=[]},Thunder.AssetManager.prototype={loadAssets:function(t,e){fetch(t).then(t=>{t.json().then(t=>{t.forEach(t=>{this.addAsset(t.group,t.type,t.src,t.tag,t.X,t.Y,t.width,t.height,t.param)}),e()})}).catch(t=>console.log(t))},addAsset:function(t,e,n,o,h,u,a,l,c){let d=new Thunder.Asset(t,e,n,o);void 0!==h&&void 0!==u&&d.setPosition(h,u),d.setSize(a,l),d.setParam(c);for(let f=0,p=d.groupArray.length;f<p;f++){void 0===this.assetList[d.groupArray[f]]&&(this.assetList[d.groupArray[f]]={});for(let v=0,y=d.typeArray.length;v<y;v++)void 0===this.assetList[d.groupArray[f]][d.typeArray[v]]&&(this.assetList[d.groupArray[f]][d.typeArray[v]]=[]),this.assetList[d.groupArray[f]][d.typeArray[v]].push(d)}return this.assetTagList[d.tag]=d,d},removeAssets:function(t,e){let n=[],o=[];void 0!==t&&(n=t.split("|")),void 0!==e&&(o=e.split("|"));for(let h=0,u=n.length;h<u;h++)if(void 0!==this.assetList[n[h]]){if(0==o.length){for(let a in this.assetList[n[h]])if(void 0!==a)for(let l=0;l<this.assetList[n[h]][a].length;l++)delete this.assetTagList[this.assetList[n[h]][a][l].tag];delete this.assetList[n[h]]}else for(let c=0,d=o.length;c<d;c++){let f=this.assetList[n[h]][o[c]];if(void 0!==f)for(let p=0,v=f.length;p<v;p++)delete this.assetTagList[f[p].tag];delete this.assetList[n[h]][o[c]]}}},removeAsset:function(t){let e=this.assetTagList[t],n=0;if(void 0!==e){let o=e.getGroupArray();for(let h=0,u=o.length;h<u;h++)for(let a in this.assetList[o[h]]){let l=this.assetList[o[h]][a];for(let c=0;c<l.length;c++)l[c].tag===t&&l.splice(c--,1)}delete this.assetTagList[t],n=1}return n},getAssets:function(t,e){let n=[],o=[],h=[];void 0!==t&&(o=t.split("|")),void 0!==e&&(h=e.split("|"));for(let u=0,a=o.length;u<a;u++)if(void 0!==this.assetList[o[u]]){if(0==h.length)for(let l in this.assetList[o[u]])void 0!==l&&(n=n.concat(this.assetList[o[u]][l]));else for(let c=0,d=h.length;c<d;c++){let f=this.assetList[o[u]][h[c]];void 0!==f&&(n=n.concat(f))}}return n},getAsset:function(t){let e=this.assetTagList[t];return void 0!==e?e:null},stack:function(t,e,n,o,h){for(let u=0,a=t.length;u<a;u++)t[u].setX(n),t[u].setY(o),e===Thunder.VERTICAL?o=o+t[u].height+h:e===Thunder.HORIZONTAL&&(n=n+t[u].width+h,o);return t},getStackedSize:function(t,e,n){let o=0;for(let h=0,u=t.length;h<u;h++)e===Thunder.VERTICAL?o+=t[h].height+n:e===Thunder.HORIZONTAL&&(o+=t[h].width+n);return o}};